<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="RT_Thread, å¼ å›éŸµ è®¡ç®—æœº åµŒå…¥å¼">
    <meta name="description" content="æœ¬ç§‘ | è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ | åµŒå…¥å¼">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google-site-verification" content="pBWoGvVEP36FzzS4xIpoMejc5UKi3RKcxd9rWWcjiDg" />
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>RT_Thread | å¼ å›éŸµ</title>

    <link rel="icon" type="image/jpeg" href="https://z3.ax1x.com/2021/08/12/f0vFHS.jpg">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;900&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?aaa6c944b0ed07922901d7fc571a171d";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
<meta name="generator" content="Hexo 5.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="å¼ å›éŸµ" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://s1.ax1x.com/2020/05/17/YRWsYT.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">å¼ å›éŸµ</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/census">
          
          <i class="fas fa-layer-group" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>ç»Ÿè®¡</span>
        </a>
      </li>
      
      <li>
        <a href="/archives">
          
          <i class="fas fa-paper-plane" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>æ—¶è½´</span>
        </a>
      </li>
      
      <li>
        <a href="/categories">
          
          <i class="fas fa-bookmark" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>åˆ†ç±»</span>
        </a>
      </li>
      
      <li>
        <a href="/tags">
          
          <i class="fas fa-tag" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>æ ‡ç­¾</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-heartbeat" style="zoom: 0.6;"></i>
      
      <span>æ¸…å•</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/List/music">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>éŸ³ä¹</span>
        </a>
      </li>
      
      <li>
        <a href="/List/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>ç›¸å†Œ</span>
        </a>
      </li>
      
      <li>
        <a href="/List/movies">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>è§†é¢‘</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-envelope" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tools" class="waves-effect waves-light">
      
      <i class="fas fa-suitcase" style="zoom: 0.6;"></i>
      
      <span>ç™¾å®ç®±</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/Windows" class="waves-effect waves-light">
      
      <i class="fas fa-desktop" style="zoom: 0.6;"></i>
      
      <span>Windows</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-link" style="zoom: 0.6;"></i>
      
      <span>å‹é“¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://s1.ax1x.com/2020/05/17/YRWsYT.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">å¼ å›éŸµ</div>
        <div class="logo-desc">
            
            æœ¬ç§‘ | è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ | åµŒå…¥å¼
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/census " style="margin-left:75px">
				  
				   <i class="fa fas fa-layer-group" style="position: absolute;left:50px" ></i>
			      
		          <span>ç»Ÿè®¡</span>
                  </a>
                </li>
              
                <li>

                  <a href="/archives " style="margin-left:75px">
				  
				   <i class="fa fas fa-paper-plane" style="position: absolute;left:50px" ></i>
			      
		          <span>æ—¶è½´</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories " style="margin-left:75px">
				  
				   <i class="fa fas fa-bookmark" style="position: absolute;left:50px" ></i>
			      
		          <span>åˆ†ç±»</span>
                  </a>
                </li>
              
                <li>

                  <a href="/tags " style="margin-left:75px">
				  
				   <i class="fa fas fa-tag" style="position: absolute;left:50px" ></i>
			      
		          <span>æ ‡ç­¾</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-heartbeat"></i>
			
			æ¸…å•
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/List/music " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>éŸ³ä¹</span>
                  </a>
                </li>
              
                <li>

                  <a href="/List/galleries " style="margin-left:75px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:50px" ></i>
			      
		          <span>ç›¸å†Œ</span>
                  </a>
                </li>
              
                <li>

                  <a href="/List/movies " style="margin-left:75px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>è§†é¢‘</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-envelope"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tools" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-suitcase"></i>
			
			ç™¾å®ç®±
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/Windows" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-desktop"></i>
			
			Windows
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-link"></i>
			
			å‹é“¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/LuckyZmj/" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/LuckyZmj/" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('è¯·è¾“å…¥è®¿é—®æœ¬æ–‡ç« çš„å¯†ç ')).toString(CryptoJS.enc.Hex)) {
                alert('å¯†ç é”™è¯¯ï¼Œå°†è¿”å›ä¸»é¡µï¼');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/LuckyZmj/imgbed@master/posts/20200928021332.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">RT_Thread</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        background-color: white;
        width: 345px;
        padding-left: 20px;
        border-radius: 10px;
        box-shadow: 0 10px 35px 2px rgba(0, 0, 0, .15), 0 5px 15px rgba(0, 0, 0, .07), 0 2px 5px -5px rgba(0, 0, 0, .1) !important;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }
    
    #toc-content {
        height: calc(100vh - 300px);
        overflow: scroll;

    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
        bottom: 120px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/keil/">
                                <span class="chip bg-color">keil</span>
                            </a>
                        
                            <a href="/tags/RT-Thread/">
                                <span class="chip bg-color">RT_Thread</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" class="post-category">
                                æ“ä½œç³»ç»Ÿ
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2021-09-08
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp;
                    2021-10-28
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    6.7k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    26 åˆ†
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><hr>
<p>â€ƒå­¦ä¹ RT_Threadä¸€å®šè¦åšæŒä¸‹å»å•Šï¼Œä¸ºäº†è·³æ§½å•Šï¼ï¼ï¼ï¼ï¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/TQOQT/picgobed/img/202110261907685.png" alt="QQ002"></p>
<h2 id="1ã€åˆè¯†RT-Thread"><a href="#1ã€åˆè¯†RT-Thread" class="headerlink" title="1ã€åˆè¯†RT_Thread"></a>1ã€åˆè¯†RT_Thread</h2><p>ç”Ÿæ´»å¸¸è§çš„ï¼šç”µè§†æœºé¡¶ç›’ã€è·¯ç”±å™¨ã€ç”µå†°ç®±ã€å¾®æ³¢ç‚‰ã€‚</p>
<p>åµŒå…¥å¼æ“ä½œç³»ç»Ÿæ˜¯åº”ç”¨åœ¨åµŒå…¥å¼ç³»ç»Ÿçš„è½¯ä»¶ï¼Œå¯¹æ¥åµŒå…¥å¼åº•å±‚ç¡¬ä»¶ä¸ä¸Šå±‚åº”ç”¨ã€‚åœ¨å¤šä»»åŠ¡ç®¡ç†ã€ä»»åŠ¡é—´é€šä¿¡ã€å†…å­˜ç®¡ç†ã€å®šæ—¶å™¨ç®¡ç†ã€è®¾å¤‡ç®¡ç†ã€‚æä¾›ä¸€å¥—å®Œæ•´çš„æœºåˆ¶ï¼Œæå¤§ç¨‹åº¦ä¸Šä¾¿åˆ©åµŒå…¥å¼åº”ç”¨ç¨‹åºçš„å¼€å‘ã€ç®¡ç†å’Œç»´æŠ¤</p>
<p>è¯ç”Ÿäº2006å¹´</p>
<h2 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h2><ol>
<li>MDKå®‰è£…</li>
<li>ç¤ºä¾‹ä»£ç <ol>
<li>srcï¼šRT_Threadå†…æ ¸ä»£ç æ–‡ä»¶</li>
<li>libcpuï¼šå„ç±»èŠ¯ç‰‡/å†…æ ¸ç§»æ¤ä»£ç ï¼Œæ¯”å¦‚STM</li>
<li>includeï¼šRT_Threadå†…æ ¸å¤´æ–‡ä»¶</li>
<li>componentsï¼šRT_Threadå¤–éƒ¨ç»„ä»¶ä»£ç ï¼Œæ¯”å¦‚Finshã€Lwip</li>
</ol>
</li>
</ol>
<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><h2 id="1ã€ç‰¹ç‚¹ï¼ˆä¼˜åŠ¿ï¼‰"><a href="#1ã€ç‰¹ç‚¹ï¼ˆä¼˜åŠ¿ï¼‰" class="headerlink" title="1ã€ç‰¹ç‚¹ï¼ˆä¼˜åŠ¿ï¼‰"></a>1ã€ç‰¹ç‚¹ï¼ˆä¼˜åŠ¿ï¼‰</h2><p>æ˜¯ä¸€ä¸ªé›†å®æ—¶æ“ä½œç³»ç»Ÿå†…æ ¸ã€ä¸­é—´ä»¶ç»„ä»¶å’Œå¼€å‘è€…ç¤¾åŒºä¸€ä½“çš„æŠ€æœ¯å¹³å°ï¼Œæ˜¯ä¸€ä¸ªç»„ä»¶å®Œæ•´ä¸°å¯Œã€é«˜åº¦å¯ä¼¸ç¼©ã€ç®€æ˜“å¼€å‘ã€è¶…ä½åŠŸè€—ã€é«˜å®‰å…¨æ€§çš„ç‰©è”ç½‘æ“ä½œç³»ç»Ÿã€‚å…·å¤‡ä¸€ä¸ªIOT OSå¹³å°æ‰€éœ€çš„æ‰€æœ‰å…³é”®ç»„ä»¶ã€‚æ”¯æŒå¸‚é¢ä¸Šæ‰€æœ‰ä¸»æµçš„ç¼–è¯‘å·¥å…·å¦‚GCCã€Keilã€IARç­‰ï¼Œå·¥å…·é“¾å®Œå–„ã€å‹å¥½ã€æ”¯æŒå„ç±»æ ‡å‡†æ¥å£ï¼Œå‡ ä¹æ”¯æŒå¸‚é¢ä¸Šæ‰€æœ‰WiFiã€MCUèŠ¯ç‰‡</p>
<h2 id="2ã€æ¦‚è¿°"><a href="#2ã€æ¦‚è¿°" class="headerlink" title="2ã€æ¦‚è¿°"></a>2ã€æ¦‚è¿°</h2><ol>
<li>RT_Threadå…¨ç§°æ˜¯Real Time-Threadï¼Œæ˜¯ä¸€ä¸ªåµŒå…¥å¼å®æ—¶å¤šçº¿ç¨‹æ“ä½œç³»ç»Ÿï¼ŒåŸºæœ¬å±æ€§ä¹‹ä¸€æ˜¯æ”¯æŒå¤šä»»åŠ¡ï¼Œåœ¨RT-Threadç³»ç»Ÿä¸­ä»»åŠ¡æ˜¯é€šè¿‡å¤šçº¿ç¨‹å®ç°çš„</li>
<li>ç›¸è¾ƒäºLinuxæ“ä½œç³»ç»Ÿï¼Œå…¶ä½“ç§¯å°ï¼Œæˆæœ¬ä½ï¼ŒåŠŸè€—ä½ï¼Œå¯åŠ¨å¿«é€Ÿï¼Œè€Œä¸”è¿˜å®æ—¶æ€§é«˜ã€å ç”¨èµ„æºå°ç­‰ç‰¹ç‚¹ï¼Œéå¸¸å®ç”¨ä¸å„ç§èµ„æºå—é™çš„åœºåˆ</li>
</ol>
<h1 id="ä¸€ã€ç¬¬ä¸€ç« "><a href="#ä¸€ã€ç¬¬ä¸€ç« " class="headerlink" title="ä¸€ã€ç¬¬ä¸€ç« "></a>ä¸€ã€ç¬¬ä¸€ç« </h1><h2 id="1ã€å¸¸è§æ“ä½œç³»ç»Ÿ"><a href="#1ã€å¸¸è§æ“ä½œç³»ç»Ÿ" class="headerlink" title="1ã€å¸¸è§æ“ä½œç³»ç»Ÿ"></a>1ã€å¸¸è§æ“ä½œç³»ç»Ÿ</h2><ol>
<li>windowsã€Linuxã€Mac</li>
<li>å®‰å“æ“ä½œç³»ç»Ÿã€IOS</li>
<li>é¸¿è’™</li>
</ol>
<h2 id="2ã€æ¶æ„"><a href="#2ã€æ¶æ„" class="headerlink" title="2ã€æ¶æ„"></a>2ã€æ¶æ„</h2><p>ä¸å…¶ä»–çš„RTOSå¦‚Free RTOSã€uC/OSçš„ä¸»è¦åŒºåˆ«ä¹‹ä¸€æ˜¯ï¼Œå®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªå®æ—¶å†…æ ¸ï¼Œè¿˜å…·å¤‡ä¸°å¯Œçš„ä¸­é—´å±‚ç»„ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/TQOQT/picgobed/img/202109111726235.png" alt="Software_framework_diagram"></p>
<h2 id="3ã€åˆ†ç±»"><a href="#3ã€åˆ†ç±»" class="headerlink" title="3ã€åˆ†ç±»"></a>3ã€åˆ†ç±»</h2><ol>
<li><p>æ ‡å‡†ç‰ˆæœ¬</p>
</li>
<li><p>nanoç‰ˆæœ¬</p>
<ol>
<li>æ˜¯ä¸€ä¸ªæç®€ç‰ˆçš„ç¡¬å®æ—¶å†…æ ¸ï¼Œä¼˜Cè¯­è¨€å¼€å‘ï¼Œé‡‡ç”¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€ç»´ï¼Œå…·æœ‰è‰¯å¥½çš„ä»£ç é£æ ¼ï¼Œæ˜¯ä¸€æ¬¾å¯è£å‰ªçš„ã€æŠ¢å å¼å®æ—¶å¤šä»»åŠ¡çš„RTOSã€‚å…¶å†…å­˜èµ„æºå ç”¨æå°ï¼ŒåŠŸèƒ½åŒ…æ‹¬ä»»åŠ¡å¤„ç†ã€è½¯ä»¶å®šæ—¶å™¨ã€ä¿¡å·é‡ã€é‚®ç®±å’Œå®æ—¶è°ƒåº¦ç›¸å¯¹å®Œæ•´çš„å®æ—¶æ“ä½œç³»ç»Ÿç‰¹æ€§ã€‚</li>
<li>ä½¿ç”¨äºå®¶ç”µã€æ¶ˆè´¹ç”µå­ã€åŒ»ç–—è®¾å¤‡ã€å·¥æ§ç­‰é¢†åŸŸå¤§é‡ä½¿ç”¨çš„32ä½ARM å…¥é—¨çº§MCUåœºåˆ</li>
<li><img src="https://cdn.jsdelivr.net/gh/TQOQT/picgobed/img/202109111838627.png" alt="æ¶æ„"></li>
<li>ç‰¹ç‚¹<ol>
<li>ä¸‹è½½ç®€å•</li>
<li>ä»£ç ç®€å•</li>
<li>ç§»æ¤ç®€å•</li>
<li>ä½¿ç”¨ç®€å•</li>
<li>èµ„æºå ç”¨å°</li>
<li>å¼€æºå…è´¹</li>
</ol>
</li>
</ol>
</li>
<li><p>Smartç‰ˆæœ¬</p>
<ol>
<li>åŸºäºRT_Threadæ“ä½œç³»ç»Ÿè¡ç”Ÿçš„å¿ƒåˆ†æ”¯ï¼Œé¢å‘å¸¦MMUã€ä¸­é«˜ç«¯åº”ç”¨çš„èŠ¯ç‰‡ã€ä¾‹å¦‚arm Cortex_Aç³»åˆ—èŠ¯ç‰‡ã€MIPSèŠ¯ç‰‡ã€å¸¦MMUçš„RISC-VèŠ¯ç‰‡</li>
<li>RT_Smartåœ¨RT_Threadæ“ä½œç³»ç»Ÿçš„åŸºç¡€ä¸Šå¯ç”¨ç‹¬ç«‹ã€å®Œæ•´çš„è¿›ç¨‹æ–¹å¼ï¼ŒåŒæ—¶ä»¥æ··åˆå¾®å†…æ ¸æ¨¡å¼æ‰§è¡Œ</li>
<li>æŠŠåº”ç”¨ä»å†…æ ¸ä¸­ç‹¬ç«‹å‡ºæ¥ï¼Œå½¢æˆç‹¬ç«‹çš„ç”¨æˆ·æ€åº”ç”¨ç¨‹åºï¼Œå¹¶å…·å¤‡ç‹¬ç«‹çš„åœ°å€ç©ºé—´</li>
</ol>
</li>
</ol>
<h1 id="äºŒã€RT-Threadç§»æ¤"><a href="#äºŒã€RT-Threadç§»æ¤" class="headerlink" title="äºŒã€RT_Threadç§»æ¤"></a>äºŒã€RT_Threadç§»æ¤</h1><h2 id="ç¢°è§çš„é—®é¢˜"><a href="#ç¢°è§çš„é—®é¢˜" class="headerlink" title="ç¢°è§çš„é—®é¢˜"></a>ç¢°è§çš„é—®é¢˜</h2><ol>
<li>ç”¨çš„Nucleo-F103RBT6çš„å¼€å‘æ¿ï¼Œä¸‹è½½æ—¶ç¢°è§</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/TQOQT/picgobed/img/202109122310165.png" alt="image-20210912231006126"></p>
<p>è§£å†³æ–¹æ³•ï¼šæŒ‰ä¸‹è½½å‰æŒ‰ä½å¤ä½ï¼Œç‚¹ä¸‹è½½åæ¾å¼€å¤ä½æŒ‰é”®</p>
<p>2.é€‰æ‹©UART2å¯æ‰“å°æ•°æ®</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">#define BSP_CLOCK_SOURCE                  ("HSI")<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é€‰æ‹©å†…éƒ¨æ™¶æŒ¯</p>
<p>å¤–éƒ¨æ˜¯</p>
<pre class="line-numbers language-none"><code class="language-none">#define BSP_CLOCK_SOURCE                  ("HSE")<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-C" data-language="C"><code class="language-C">#define BSP_CLOCK_SOURCE_FREQ_MHZ         ((int32_t)0)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¤–éƒ¨æ™¶æŒ¯é¢‘ç‡</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">#define BSP_CLOCK_SYSTEM_FREQ_MHZ         ((int32_t)72)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å†…éƒ¨æ™¶æŒ¯é¢‘ç‡</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">int main(void)
{
    //int count = 1;
#if 0
    while (count++)
    {
        LOG_D("Hello RT-Thread!");
        rt_thread_mdelay(1000);
    }
#endif
    return RT_EOK;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ—¶ï¼Œæ‰“å¼€xcomeè¾“å…¥helpå¯æŸ¥çœ‹æ•°æ®</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">msh &gt;help
RT-Thread shell commands:
clear            - clear the terminal screen
version          - show RT-Thread version information
list_thread      - list thread
list_sem         - list semaphore in system
list_event       - list event in system
list_mutex       - list mutex in system
list_mailbox     - list mail box in system
list_msgqueue    - list message queue in system
list_mempool     - list memory pool in system
list_timer       - list timer in system
list_device      - list device in system
help             - RT-Thread shell help.
ps               - List threads in the system.
free             - Show the memory usage in the system.
reboot           - Reboot System
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="ä¸‰ã€å†…æ ¸ä»‹ç»"><a href="#ä¸‰ã€å†…æ ¸ä»‹ç»" class="headerlink" title="ä¸‰ã€å†…æ ¸ä»‹ç»"></a>ä¸‰ã€å†…æ ¸ä»‹ç»</h1><h2 id="å†…æ ¸æ¡†æ¶"><a href="#å†…æ ¸æ¡†æ¶" class="headerlink" title="å†…æ ¸æ¡†æ¶"></a>å†…æ ¸æ¡†æ¶</h2><h3 id="1ã€å®æ—¶å†…æ ¸"><a href="#1ã€å®æ—¶å†…æ ¸" class="headerlink" title="1ã€å®æ—¶å†…æ ¸"></a>1ã€å®æ—¶å†…æ ¸</h3><p>å†…æ ¸åº“æ˜¯ä¸ºäº†ä¿éšœå†…æ ¸èƒ½å¤Ÿç‹¬ç«‹è¿è¡Œçš„ä¸€å¥—å°å‹çš„ç±»ä¼¼Cåº“çš„å‡½æ•°å®ç°å­é›†ï¼Œè¿™éƒ¨åˆ†æ ¹æ®ç¼–è¯‘å™¨çš„ä¸åŒè‡ªå¸¦Cåº“çš„æƒ…å†µä¹Ÿä¼šæœ‰äº›ä¸åŒï¼Œå½“ä½¿ç”¨GNUGCCç¼–è¯‘å™¨æ—¶ï¼Œä¼šæºå¸¦æ›´å¤šçš„æ ‡å‡†Cåº“å®ç°</p>
<p>å®æ—¶å†…æ ¸çš„å®ç°åŒ…æ‹¬</p>
<ol>
<li><p>å¯¹è±¡ç®¡ç†</p>
</li>
<li><p>å®æ—¶è°ƒåº¦å™¨</p>
</li>
<li><p>çº¿ç¨‹ç®¡ç†</p>
</li>
<li><p>çº¿ç¨‹é—´é€šä¿¡</p>
</li>
<li><p>æ—¶é’Ÿç®¡ç†</p>
</li>
<li><p>å†…å­˜ç®¡ç†</p>
</li>
<li><p>è®¾å¤‡ç®¡ç†</p>
<p>å†…æ ¸æœ€å°çš„èµ„æºå ç”¨æƒ…å†µæ˜¯3KB ROMï¼Œ1.2KB RAM</p>
</li>
</ol>
<h3 id="2ã€çº¿ç¨‹è°ƒåº¦"><a href="#2ã€çº¿ç¨‹è°ƒåº¦" class="headerlink" title="2ã€çº¿ç¨‹è°ƒåº¦"></a>2ã€çº¿ç¨‹è°ƒåº¦</h3><p>â€‹    æ˜¯æœ¬æ“ä½œç³»ç»Ÿä¸­æœ€å°çš„è°ƒåº¦å•ä½ï¼Œæ˜¯åŸºäºä¼˜å…ˆçº§çš„å…¨å å¼å¤šçº¿ç¨‹è°ƒåº¦ç®—æ³•ï¼Œå³åœ¨ç³»ç»Ÿä¸­é™¤äº†ä¸­æ–­å¤„ç†å‡½æ•°ã€è°ƒåº¦å™¨ä¸Šé”éƒ¨åˆ†çš„ä»£ç å’Œç¦æ­¢ä¸­æ–­çš„ä»£ç æ—¶ä¸å¯æŠ¢å çš„ï¼Œå…¶ä»–éƒ¨åˆ†éƒ½æ˜¯å¯ä»¥æŠ¢å çš„ã€‚åŒ…æ‹¬çº¿ç¨‹è°ƒåº¦å™¨æœ¬èº«ã€‚</p>
<p>â€‹    æ”¯æŒ256ä¸ªçº¿ç¨‹ä¼˜å…ˆçº§ï¼ˆå¯é€šè¿‡é…ç½®æ–‡ä»¶æ›´æ”¹ä¸ºæœ€å¤§æ”¯æŒ32ä¸ªæˆ–8ä¸ªä¼˜å…ˆçº§ï¼Œé’ˆå¯¹STM32é»˜è®¤é…ç½®æ˜¯32ä¸ªçº¿ç¨‹ä¼˜å…ˆçº§ï¼‰ï¼Œ0è¡¨ç¤ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œæœ€ä½ä¼˜å…ˆçº§ç•™ç»™ç©ºé—²çº¿ç¨‹ä½¿ç”¨ï¼›ä¹Ÿæ”¯æŒåˆ›å»ºå¤šä¸ªå…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„çº¿ç¨‹ã€‚ç›¸åŒä¼˜å…ˆçº§çš„çº¿ç¨‹é—´é‡‡ç”¨æ—¶é—´ç‰‡çš„è½®è½¬è°ƒåº¦ç®—æ³•è¿›è¡Œè°ƒåº¦ï¼Œä½¿æ¯ä¸ªçº¿ç¨‹è¿è¡Œç›¸åº”æ—¶é—´ã€‚</p>
<p>â€‹    è°ƒåº¦å™¨åœ¨å¯»æ‰¾å¤„äºå°±ç»ªçŠ¶æ€çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹æ—¶ï¼Œæ‰€ç»å†çš„æ—¶é—´æ˜¯æ’å®šçš„ï¼Œç³»ç»Ÿä¹Ÿä¸é™åˆ¶çº¿ç¨‹æ•°é‡çš„å¤šå°‘ï¼Œçº¿ç¨‹æ•°ç›®åªä¸ç¡¬ä»¶å¹³å°çš„å…·ä½“å†…å­˜ç›¸å…³ã€‚</p>
<h3 id="3ã€æ—¶é’Ÿç®¡ç†"><a href="#3ã€æ—¶é’Ÿç®¡ç†" class="headerlink" title="3ã€æ—¶é’Ÿç®¡ç†"></a>3ã€æ—¶é’Ÿç®¡ç†</h3><ol>
<li>â€‹    æ—¶é’Ÿç®¡ç†ä»¥æ—¶é’ŸèŠ‚æ‹ä¸ºåŸºç¡€ï¼Œæ—¶é’ŸèŠ‚æ‹æ˜¯æœ¬ç³»ç»Ÿæœ€å°çš„æ—¶é’Ÿå•ä½ã€‚</li>
<li>RT_Threadçš„å®šæ—¶å™¨æä¾›ä¸¤ç±»å®šæ—¶å™¨æœºåˆ¶<ol>
<li>å•æ¬¡è§¦å‘å®šæ—¶å™¨<ol>
<li>åœ¨å¯åŠ¨ååªä¼šè§¦å‘ä¸€æ¬¡å®šæ—¶å™¨äº‹ä»¶ï¼Œç„¶åå®šæ—¶å™¨è‡ªåŠ¨åœæ­¢</li>
</ol>
</li>
<li>å‘¨æœŸè§¦å‘å®šæ—¶å™¨<ol>
<li>ä¼šå‘¨æœŸæ€§çš„è§¦å‘å®šæ—¶å™¨äº‹ä»¶ï¼Œç›´åˆ°ç”¨æˆ·æ‰‹åŠ¨çš„åœæ­¢å®šæ—¶å™¨ï¼Œå¦åˆ™å°†æ°¸è¿œæŒç»­æ‰§è¡Œä¸‹å»ã€‚</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="4ã€çº¿ç¨‹é—´åŒæ­¥"><a href="#4ã€çº¿ç¨‹é—´åŒæ­¥" class="headerlink" title="4ã€çº¿ç¨‹é—´åŒæ­¥"></a>4ã€çº¿ç¨‹é—´åŒæ­¥</h3><ol>
<li>â€‹    é‡‡ç”¨ä¿¡å·é‡ã€äº’æ–¥é‡ä¸äº‹ä»¶é›†å®ç°çº¿ç¨‹é—´åŒæ­¥</li>
<li>çº¿ç¨‹é€šè¿‡å¯¹ä¿¡å·é‡ã€äº’æ–¥é‡çš„è·å–ä¸é‡Šæ”¾è¿›è¡ŒåŒæ­¥</li>
<li>äº’æ–¥é‡é‡‡ç”¨ä¼˜å…ˆçº§ç»§æ‰¿çš„æ–¹å¼è§£å†³äº†å®æ—¶ç³»ç»Ÿä¸­å¸¸è§çš„ä¼˜å…ˆçº§ç¿»è½¬é—®é¢˜</li>
<li>çº¿ç¨‹åŒæ­¥æœºåˆ¶æ”¯æŒçº¿ç¨‹æŒ‰ä¼˜å…ˆçº§ç­‰å¾…æˆ–æŒ‰å…ˆè¿›å…ˆå‡ºæ–¹å¼è·å–ä¿¡å·é‡æˆ–äº’æ–¥é‡</li>
<li>çº¿ç¨‹é€šè¿‡å¯¹äº‹ä»¶çš„å‘é€ä¸æ¥æ”¶è¿›è¡ŒåŒæ­¥</li>
<li>äº‹ä»¶é›†æ”¯æŒå¤šäº‹ä»¶çš„â€œæˆ–è§¦å‘â€å’Œâ€œä¸è§¦å‘â€ï¼Œé€‚åˆä¸çº¿ç¨‹ç­‰å¾…å¤šä¸ªäº‹ä»¶çš„æƒ…å†µ</li>
</ol>
<h3 id="5ã€çº¿ç¨‹é€šä¿¡"><a href="#5ã€çº¿ç¨‹é€šä¿¡" class="headerlink" title="5ã€çº¿ç¨‹é€šä¿¡"></a>5ã€çº¿ç¨‹é€šä¿¡</h3><ol>
<li>æ”¯æŒé‚®ç®±å’Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰é€šä¿¡æœºåˆ¶ã€‚é‚®ç®±é•¿åº¦å›ºå®šä¸º4å­—èŠ‚å¤§å°</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—èƒ½å¤Ÿæ¥æ”¶ä¸å›ºå®šé•¿åº¦çš„æ¶ˆæ¯ï¼Œå¹¶æŠŠæ¶ˆæ¯ç¼“å­˜åœ¨è‡ªå·±çš„å†…å­˜ç©ºé—´ä¸­</li>
<li>é‚®ç®±æ•ˆç‡è¾ƒæ¶ˆæ¯é˜Ÿåˆ—æ›´ä¸ºé«˜æ•ˆã€‚é‚®ç®±å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„å‘é€åŠ¨ä½œå¯å®‰å…¨ç”¨äºä¸­æ–­æœåŠ¡ä¾‹ç¨‹ä¸­</li>
<li>é€šä¿¡æœºåˆ¶æ”¯æŒçº¿ç¨‹æŒ‰ä¼˜å…ˆçº§ç­‰å¾…æˆ–æŒ‰å…ˆè¿›å…ˆå‡ºæ–¹å¼è·å–</li>
</ol>
<h3 id="6ã€å†…å­˜ç®¡ç†"><a href="#6ã€å†…å­˜ç®¡ç†" class="headerlink" title="6ã€å†…å­˜ç®¡ç†"></a>6ã€å†…å­˜ç®¡ç†</h3><ol>
<li>æ”¯æŒé™æ€å†…å­˜æ± ç®¡ç†é›†åŠ¨æ€å†…å­˜å †ç®¡ç†ã€‚å½“é™æ€å†…å­˜æ± å…·æœ‰å¯ç”¨å†…å­˜æ—¶ï¼Œç³»ç»Ÿå¯¹å†…å­˜å—åˆ†é…çš„æ—¶é—´å°†æ˜¯æ’å®šçš„ã€‚<ol>
<li>å½“é™æ€å†…å­˜æ± ä¸ºç©ºæ—¶ï¼Œç³»ç»Ÿå°†ç”³è¯·å†…å­˜å—çš„çº¿ç¨‹æŒ‚èµ·æˆ–é˜»å¡æ‰ï¼ˆå³çº¿ç¨‹ç­‰å¾…ä¸€æ®µæ—¶é—´åä»ä¸ºè·å¾—å†…å­˜å—å°±æ”¾å¼ƒç”³è¯·å¹¶è¿”å›ï¼Œæˆ–è€…ç«‹å³è¿”å›ã€‚<strong>ç­‰å¾…çš„æ—¶é—´å–å†³ä¸ç”³è¯·å†…å­˜å—æ—¶è®¾ç½®çš„ç­‰å¾…æ—¶é—´å‚æ•°</strong>ï¼‰ï¼Œå½“å…¶ä»–çº¿ç¨‹é‡Šæ”¾å†…å­˜å—åˆ°å†…å­˜æ± æ—¶ï¼Œå¦‚æœæœ‰æŒ‚èµ·çš„å¾…åˆ†é…å†…å­˜å—çš„çº¿ç¨‹å­˜åœ¨çš„è¯ï¼Œåˆ™ç³»ç»Ÿä¼šå°†è¿™ä¸ªçº¿ç¨‹å”¤é†’</li>
<li>åŠ¨æ€å†…å­˜å †ç®¡ç†æ¨¡å—åœ¨ç³»ç»Ÿèµ„æºä¸åŒçš„æƒ…å†µä¸‹ï¼Œåˆ†åˆ«æä¾›äº†é¢å‘å°å†…å­˜ç³»ç»Ÿçš„å†…å­˜ç®¡ç†ç®—æ³•åŠé¢å‘å¤§å†…å­˜ç³»ç»Ÿçš„<strong>SLABå†…å­˜ç®¡ç†ç®—æ³•</strong><ol>
<li> è¿˜æœ‰ä¸€ç§åŠ¨æ€å†…å­˜å †ç®¡ç†å«åšmemheapï¼Œé€‚ç”¨äºç³»ç»Ÿå«æœ‰å¤šä¸ªåœ°å€å¯ä¸è¿ç»­çš„å†…å­˜å †ã€‚ä½¿ç”¨memheapå¯ä»¥å°†å¤šä¸ªå†…å­˜å †â€œç²˜è¿â€åœ¨ä¸€èµ·ï¼Œè®©ç”¨æˆ·æ“ä½œå…ˆæ˜¯åœ¨æ“ä½œä¸€ä¸ªå†…å­˜å †</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="7ã€I-Oè®¾å¤‡ç®¡ç†"><a href="#7ã€I-Oè®¾å¤‡ç®¡ç†" class="headerlink" title="7ã€I/Oè®¾å¤‡ç®¡ç†"></a>7ã€I/Oè®¾å¤‡ç®¡ç†</h3><p>â€‹    å°†PINã€I2Cã€SPIã€USBã€UARTç­‰ä½œä¸ºå¤–è®¾è®¾å¤‡ï¼Œç»Ÿä¸€é€šè¿‡è®¾å¤‡æ³¨å†Œå®Œæˆã€‚å®ç°äº†æŒ‰åç§°è®¿é—®çš„è®¾å¤‡ç®¡ç†å­ç³»ç»Ÿï¼Œå¯æŒ‰ç…§ç»Ÿä¸€çš„APIç•Œé¢è®¿é—®ç¡¬ä»¶è®¾å¤‡ã€‚åœ¨è®¾å¤‡é©±åŠ¨æ¥å£ä¸Šï¼Œæ ¹æ®åµŒå…¥å¼ç³»ç»Ÿçš„ç‰¹ç‚¹ï¼Œå¯¹ä¸åŒçš„è®¾å¤‡å¯ä»¥æŒ‚æ¥ç›¸åº”çš„äº‹ä»¶ã€‚å½“è®¾å¤‡äº‹ä»¶è§¦å‘æ—¶ï¼Œç”±é©±åŠ¨ç¨‹åºé€šçŸ¥ç»™ä¸Šå±‚çš„åº”ç”¨ç¨‹åº</p>
<h2 id="å†…æ ¸å¯åŠ¨æµç¨‹"><a href="#å†…æ ¸å¯åŠ¨æµç¨‹" class="headerlink" title="å†…æ ¸å¯åŠ¨æµç¨‹"></a>å†…æ ¸å¯åŠ¨æµç¨‹</h2><p>RT-Thread æ”¯æŒå¤šç§å¹³å°å’Œå¤šç§ç¼–è¯‘å™¨ï¼Œè€Œ rtthread_startup() å‡½æ•°æ˜¯ RT-Thread è§„å®šçš„ç»Ÿä¸€å¯åŠ¨å…¥å£ã€‚ä¸€èˆ¬æ‰§è¡Œé¡ºåºæ˜¯ï¼šç³»ç»Ÿå…ˆä»å¯åŠ¨æ–‡ä»¶å¼€å§‹è¿è¡Œï¼Œç„¶åè¿›å…¥ RT-Thread çš„å¯åŠ¨å‡½æ•° rtthread_startup() ï¼Œæœ€åè¿›å…¥ç”¨æˆ·å…¥å£å‡½æ•° main()ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p>â€‹    <img src="https://cdn.jsdelivr.net/gh/TQOQT/picgobed/img/202109162218835.png" alt="å¯åŠ¨æµç¨‹"></p>
<p> æµç¨‹åœ¨startup_stm32f10xxb.sä¸­çš„entryä¸­çš„rtthread_startup();å¯ä»¥æŸ¥çœ‹åˆ°çº¿ç¨‹æµç¨‹</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">tid = rt_thread_create("main", main_thread_entry, RT_NULL,
                           RT_MAIN_THREAD_STACK_SIZE, RT_MAIN_THREAD_PRIORITY, 20);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>çº¿ç¨‹åå­—æ˜¯mainï¼Œçº¿ç¨‹IDæ˜¯tidï¼Œçº¿ç¨‹æ‰§è¡Œå‡½æ•°æ˜¯main_thread_entryï¼Œä¼˜å…ˆçº§æ˜¯RT_MAIN_THRED_PRIORITYï¼Œæ ˆçš„å¤§å°æ˜¯RT_MAIN_THREAD_STACK_SIZEï¼Œ</p>
<h1 id="å››ã€çº¿ç¨‹ç®¡ç†"><a href="#å››ã€çº¿ç¨‹ç®¡ç†" class="headerlink" title="å››ã€çº¿ç¨‹ç®¡ç†"></a>å››ã€çº¿ç¨‹ç®¡ç†</h1><ol>
<li>å¤šä»»åŠ¡æ˜¯é€šè¿‡å¤šçº¿ç¨‹æ–¹å¼å®ç°ï¼Œçº¿ç¨‹æ˜¯ä»»åŠ¡çš„è½½ä½“ï¼Œæ˜¯RTTä¸­æœ€åŸºæœ¬çš„è°ƒåº¦å•ä½</li>
<li>çº¿ç¨‹æ‰§è¡Œæ—¶çš„è¿è¡Œç¯å¢ƒç§°ä¸ºä¸Šä¸‹æ–‡ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯å„ç§å˜é‡å’Œæ•°æ®ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„å¯„å­˜å™¨å˜é‡ã€å †æ ˆã€å†…å­˜ä¿¡æ¯ç­‰</li>
<li>çº¿ç¨‹åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œå®ƒä¼šè®¤ä¸ºè‡ªå·±ç‹¬å CPUè¿è¡Œ </li>
</ol>
<h2 id="4-1ã€çº¿ç¨‹ç®¡ç†ç‰¹ç‚¹"><a href="#4-1ã€çº¿ç¨‹ç®¡ç†ç‰¹ç‚¹" class="headerlink" title="4.1ã€çº¿ç¨‹ç®¡ç†ç‰¹ç‚¹"></a>4.1ã€çº¿ç¨‹ç®¡ç†ç‰¹ç‚¹</h2><p>ä¸»è¦åŠŸèƒ½æ—¶å¯¹çº¿ç¨‹è¿›è¡Œç®¡ç†å’Œè°ƒåº¦ï¼Œç³»ç»Ÿä¸­æ€»å…±å­˜åœ¨ä¸¤ç±»çº¿ç¨‹ï¼Œåˆ†åˆ«æ—¶<strong>ç³»ç»Ÿçº¿ç¨‹</strong>å’Œ<strong>ç”¨æˆ·çº¿ç¨‹</strong>ï¼Œé‡ç‚¹æ”¾åœ¨ç”¨æˆ·çº¿ç¨‹</p>
<ol>
<li>ç³»ç»Ÿçº¿ç¨‹æ—¶ç”±RT_Threadå†…æ ¸åˆ›å»ºçš„çº¿ç¨‹</li>
<li>ç”¨æˆ·çº¿ç¨‹æ˜¯ç”±åº”ç”¨ç¨‹åºåˆ›å»ºçš„çº¿ç¨‹</li>
</ol>
<p>ä¸¤ç±»çº¿ç¨‹éƒ½ä¼šä»å†…æ ¸å¯¹è±¡å®¹å™¨ä¸­åˆ†é…çº¿ç¨‹å¯¹è±¡ï¼Œå½“çº¿ç¨‹è¢«åˆ é™¤æ—¶ï¼Œä¹Ÿä¼šè¢«ä»å¯¹è±¡å®¹å™¨ä¸­åˆ é™¤ã€‚</p>
<h2 id="4-2ã€çº¿ç¨‹å·¥ä½œæœºåˆ¶"><a href="#4-2ã€çº¿ç¨‹å·¥ä½œæœºåˆ¶" class="headerlink" title="4.2ã€çº¿ç¨‹å·¥ä½œæœºåˆ¶"></a>4.2ã€çº¿ç¨‹å·¥ä½œæœºåˆ¶</h2><h3 id="4-2-1ã€çº¿ç¨‹æ§åˆ¶å—"><a href="#4-2-1ã€çº¿ç¨‹æ§åˆ¶å—" class="headerlink" title="4.2.1ã€çº¿ç¨‹æ§åˆ¶å—"></a>4.2.1ã€çº¿ç¨‹æ§åˆ¶å—</h3><p>çº¿ç¨‹æ§åˆ¶å—ç”±ç»“æ„ä½“struct rt_threadè¡¨ç¤ºï¼Œæ˜¯ç®¡ç†çº¿ç¨‹çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œä¼šå­˜æ”¾çº¿ç¨‹çš„ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚ä¼˜å…ˆçº§ã€çº¿ç¨‹åç§°ã€çº¿ç¨‹çŠ¶æ€ï¼Œä¹ŸåŒ…å«çº¿ç¨‹ä¸çº¿ç¨‹ä¹‹é—´è¿æ¥ç”¨çš„é“¾è¡¨ç»“æ„ï¼Œçº¿ç¨‹ç­‰å¾…äº‹ä»¶é›†åˆ</p>
<p> <strong><em>cleanupå‡½æ•°æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°ï¼Œä¼šåœ¨çº¿ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œè¢«idleçº¿ç¨‹å›è°ƒä¸€æ¬¡ï¼Œæ‰§è¡Œç”¨æˆ·è®¾ç½®çš„æ¸…ç†ç°åœºç­‰å·¥ä½œ</em></strong></p>
<h3 id="4-2-2ã€çº¿ç¨‹å±æ€§"><a href="#4-2-2ã€çº¿ç¨‹å±æ€§" class="headerlink" title="4.2.2ã€çº¿ç¨‹å±æ€§"></a>4.2.2ã€çº¿ç¨‹å±æ€§</h3><ol>
<li>çº¿ç¨‹æ ˆ<ol>
<li>RT_Threadçº¿ç¨‹å…·æœ‰ç‹¬ç«‹çš„æ ˆï¼Œå½“è¿›è¡Œçº¿ç¨‹åˆ‡æ¢æ—¶ï¼Œä¼šå°†å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡å­˜åœ¨æ ˆä¸­ï¼Œå½“çº¿ç¨‹è¦æ¢å¤è¿è¡Œæ—¶ï¼Œå†ä»æ ˆä¸­è¯»å–ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿›è¡Œæ¢å¤</li>
</ol>
</li>
<li>çº¿ç¨‹çŠ¶æ€</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/TQOQT/picgobed/img/202110272039860.png" alt="image-20211027203924158"></p>
<ol>
<li>çº¿ç¨‹ä¼˜å…ˆçº§<ol>
<li>æœ€å¤§æ”¯æŒ256ä¸ªçº¿ç¨‹ä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œ0ä¸ºæœ€é«˜ä¼˜å…ˆçº§ã€‚èµ„æºç´§å¼ çš„ç³»ç»Ÿä¸­ï¼Œå¯æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©åªæ”¯æŒ8ä¸ªæˆ–32ä¸ªä¼˜å…ˆçº§çš„ç³»ç»Ÿé…ç½®ã€‚</li>
<li>Cortex-Mç³»åˆ—ä¸­æ™®éé‡‡ç”¨32ä¸ªä¼˜å…ˆçº§ï¼Œæœ€ä½ä¼˜å…ˆçº§é»˜è®¤åˆ†é…ç»™ç©ºé—²çº¿ç¨‹ï¼ˆ<strong>idle</strong>ï¼‰ä½¿ç”¨ï¼Œç”¨æˆ·ä¸€èˆ¬ä¸ä½¿ç”¨ã€‚åœ¨ç³»ç»Ÿä¸­ï¼Œå½“æœ‰æ¯”å½“å‰çº¿ç¨‹ä¼˜å…ˆçº§æ›´é«˜çš„çº¿ç¨‹å°±ç»ªæ—¶ï¼Œå½“å‰çº¿ç¨‹å°†ç«‹åˆ»è¢«æ¢å‡ºï¼Œé«˜ä¼˜å…ˆçº§çº¿ç¨‹æŠ¢å å¤„ç†å™¨è¿è¡Œ</li>
</ol>
</li>
<li>æ—¶é—´ç‰‡<ol>
<li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰æ—¶é—´ç‰‡è¿™ä¸ªå‚æ•°ï¼Œä½†æ—¶é—´ç‰‡ä»…å¯¹ä¼˜å…ˆçº§ç›¸åŒçš„å°±ç»ªæ€çº¿ç¨‹æœ‰æ•ˆ</li>
</ol>
</li>
</ol>
<h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a><strong>æ³¨æ„</strong></h4><p>â€‹    å¦‚æœä¸€ä¸ªçº¿ç¨‹ä¸­ç¨‹åºé™·å…¥æ­»å¾ªç¯æ“ä½œï¼Œåˆ™æ¯”å®ƒä¼˜å…ˆçº§ä½çš„çº¿ç¨‹éƒ½ä¸èƒ½æ‰§è¡Œï¼Œæ‰€ä»¥åœ¨å®æ—¶æ“ä½œç³»ç»Ÿä¸­å¿…é¡»æ³¨æ„ï¼šçº¿ç¨‹ä¸­ä¸èƒ½é™·å…¥æ­»å¾ªç¯æ“ä½œï¼Œå¿…é¡»è¦æœ‰è®©å‡ºCPUä½¿ç”¨æƒçš„åŠ¨ä½œï¼Œ<u><strong>å¦‚å¾ªç¯ä¸­è°ƒç”¨å»¶æ—¶å‡½æ•°ï¼ˆè¿›å…¥æŒ‚èµ·çŠ¶æ€ï¼‰æˆ–ä¸»åŠ¨æŒ‚èµ·</strong></u></p>
<h3 id="4-2-3ã€çº¿ç¨‹çŠ¶æ€ä¹‹é—´åˆ‡æ¢"><a href="#4-2-3ã€çº¿ç¨‹çŠ¶æ€ä¹‹é—´åˆ‡æ¢" class="headerlink" title="4.2.3ã€çº¿ç¨‹çŠ¶æ€ä¹‹é—´åˆ‡æ¢"></a>4.2.3ã€çº¿ç¨‹çŠ¶æ€ä¹‹é—´åˆ‡æ¢</h3><p><img src="https://cdn.jsdelivr.net/gh/TQOQT/picgobed/img/202110280949649.png" alt="çº¿ç¨‹çŠ¶æ€è½¬æ¢å›¾"></p>
<h3 id="4-2-4ã€ç³»ç»Ÿçº¿ç¨‹"><a href="#4-2-4ã€ç³»ç»Ÿçº¿ç¨‹" class="headerlink" title="4.2.4ã€ç³»ç»Ÿçº¿ç¨‹"></a>4.2.4ã€ç³»ç»Ÿçº¿ç¨‹</h3><p>RT_Threadå†…æ ¸ä¸­çš„ç³»ç»Ÿçº¿ç¨‹æœ‰ç©ºé—²çº¿ç¨‹å’Œä¸»çº¿ç¨‹</p>
<h2 id="4-3ã€çº¿ç¨‹ç›¸å…³æ“ä½œ"><a href="#4-3ã€çº¿ç¨‹ç›¸å…³æ“ä½œ" class="headerlink" title="4.3ã€çº¿ç¨‹ç›¸å…³æ“ä½œ"></a>4.3ã€çº¿ç¨‹ç›¸å…³æ“ä½œ</h2><p>åˆ›å»º/åˆå§‹åŒ–ã€å¯åŠ¨ã€è¿è¡Œã€åˆ é™¤/è„±ç¦»ã€‚</p>
<p>åŠ¨æ€çº¿ç¨‹ï¼šæ˜¯ç³»ç»Ÿè‡ªåŠ¨ä»åŠ¨æ€å†…å­˜å †ä¸Šåˆ†é…ç©ºé—´å’Œçº¿ç¨‹å¥æŸ„ï¼ˆåˆå§‹åŒ–heapä¹‹åæ‰èƒ½ä½¿ç”¨createåˆ›å»ºåŠ¨æ€çº¿ç¨‹ï¼‰</p>
<p>é™æ€çº¿ç¨‹ï¼šç”±ç”¨æˆ·åˆ†é…æ ˆç©ºé—´ä¸çº¿ç¨‹å¥æŸ„</p>
<p><img src="https://cdn.jsdelivr.net/gh/TQOQT/picgobed/img/202110280957492.png"></p>
<h3 id="4-3-1ã€åŠ¨æ€çº¿ç¨‹"><a href="#4-3-1ã€åŠ¨æ€çº¿ç¨‹" class="headerlink" title="4.3.1ã€åŠ¨æ€çº¿ç¨‹"></a>4.3.1ã€åŠ¨æ€çº¿ç¨‹</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">rt_thread_t th1_ptr = NULL; //ç»“æ„ä½“
å˜é‡æ¥æ”¶è¿”å›å€¼

void th_entry(void *parameter)
{
    while(1){
        rt_kprintf("th_entry running...\n");
        rt_thread_mdelay(1000);
    }


}

int main(void)
{
    //å‡½æ•°åç§°
    //å…¥å£å‡½æ•°
    //ç»™çº¿ç¨‹å…¥å£å‡½æ•°ä¼ å‚
    //çº¿ç¨‹æ ˆçš„å¤§å°
    //ä¼˜å…ˆçº§
    //ç³»ç»Ÿæ»´ç­”æ—¶é—´
    th1_ptr = rt_thread_create("th_demo",
                                th_entry,
                                NULL,1024,
                                 20,
                                 5);
    if (th1_ptr == RT_NULL) {
        LOG_E("rt_thread_create failed...\n");
    }
    LOG_D("rt_thread_create successed...\n");
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-C" data-language="C"><code class="language-C"> \ | /
- RT -     Thread Operating System
 / | \     4.0.3 build Oct 28 2021
 2006 - 2020 Copyright by rt-thread team
[0m[D/main] rt_thread_create successed...
[0m
msh &gt;help
RT-Thread shell commands:
clear            - clear the terminal screen
version          - show RT-Thread version information
list_thread      - list thread
list_sem         - list semaphore in system
list_event       - list event in system
list_mutex       - list mutex in system
list_mailbox     - list mail box in system
list_msgqueue    - list message queue in system
list_mempool     - list memory pool in system
list_timer       - list timer in system
list_device      - list device in system
help             - RT-Thread shell help.
ps               - List threads in the system.
free             - Show the memory usage in the system.
reboot           - Reboot System

msh &gt;list_thread
thread   pri  status      sp     stack size max used left tick  error
-------- ---  ------- ---------- ----------  ------  ---------- ---
th_demo   20  init    0x00000040 0x00000400    06%   0x00000005 000
tshell    20  running 0x000000c8 0x00001000    14%   0x0000000a 000
tidle0    31  ready   0x00000070 0x00000100    57%   0x0000000c 000
timer      4  suspend 0x0000007c 0x00000200    24%   0x00000009 000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¨‹åºä¸‹è½½è¿›å»åï¼Œå¤ä½å°±å¯ä»¥çœ‹åˆ°æ‰“å°å‡ºæ¥çš„å­—ç¬¦ä¸²ï¼ŒhelpæŸ¥çœ‹å‘½ä»¤ï¼Œlist_threadæŸ¥çœ‹æœ‰å“ªäº›çº¿ç¨‹</p>
<p>rt_thread_createï¼ˆâ€çº¿ç¨‹åç§°â€œï¼Œå…¥å£å‡½æ•°ï¼Œçº¿ç¨‹å…¥å£å‡½æ•°çš„ä¼ å‚ï¼Œçº¿ç¨‹æ ˆçš„å¤§å°ï¼Œä¼˜å…ˆçº§ï¼Œç³»ç»Ÿæ»´ç­”æ—¶é—´ï¼‰</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">rt_thread_t th1_ptr = NULL; //ç»“æ„ä½“å˜é‡æ¥æ”¶è¿”å›å€¼

void th_entry(void *parameter)
{
    while(1){
        rt_kprintf("th_entry running...\n");
        rt_thread_mdelay(1000);
    }


}

int main(void)
{
    //å‡½æ•°åç§°
    //å…¥å£å‡½æ•°
    //ç»™çº¿ç¨‹å…¥å£å‡½æ•°ä¼ å‚
    //çº¿ç¨‹æ ˆçš„å¤§å°
    //ä¼˜å…ˆçº§
    //ç³»ç»Ÿæ»´ç­”æ—¶é—´
    th1_ptr = rt_thread_create("th_demo",
                                th_entry,
                                NULL,1024,
                                 20,
                                 5);
    if (th1_ptr == RT_NULL) {
        LOG_E("rt_thread_create failed...\n");
        return RT_ENOMEM;
    }
    LOG_D("rt_thread_create successed...\n");
    rt_thread_startup(th1_ptr);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-C" data-language="C"><code class="language-C"> \ | /
- RT -     Thread Operating System
 / | \     4.0.3 build Oct 28 2021
 2006 - 2020 Copyright by rt-thread team
[0m[D/main] rt_thread_create successed...
[0m
msh &gt;th_entry running...
th_entry running...
th_entry running...
list_thread
thread   pri  status      sp     stack size max used left tick  error
-------- ---  ------- ---------- ----------  ------  ---------- ---
th_demo   20  suspend 0x000000a8 0x00000400    20%   0x00000005 000
tshell    20  running 0x000000c8 0x00001000    14%   0x00000004 000
tidle0    31  ready   0x00000070 0x00000100    57%   0x00000002 000
timer      4  suspend 0x0000007c 0x00000200    24%   0x00000009 000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸ºæ‰“å°th_entry runningâ€¦æ—¶é—´æ˜¯éå¸¸çŸ­çš„ï¼Œå¤§éƒ¨åˆ†æ—¶é—´æ˜¯åœ¨mdelayä¸Šï¼Œæ‰€ä»¥æ˜¯å¤„ä»¥æŒ‚èµ·çŠ¶æ€</p>
<p>rt_thread_startupï¼ˆçº¿ç¨‹åˆ›å»ºåèµ‹å€¼çš„ï¼‰</p>
<table>
<thead>
<tr>
<th><strong>å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>çº¿ç¨‹çš„åç§°ï¼›çº¿ç¨‹åç§°çš„æœ€å¤§é•¿åº¦ç”± rtconfig.h ä¸­çš„å® RT_NAME_MAX æŒ‡å®šï¼Œå¤šä½™éƒ¨åˆ†ä¼šè¢«è‡ªåŠ¨æˆªæ‰</td>
</tr>
<tr>
<td>entry</td>
<td>çº¿ç¨‹å…¥å£å‡½æ•°</td>
</tr>
<tr>
<td>parameter</td>
<td>çº¿ç¨‹å…¥å£å‡½æ•°å‚æ•°</td>
</tr>
<tr>
<td>stack_size</td>
<td>çº¿ç¨‹æ ˆå¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚</td>
</tr>
<tr>
<td>priority</td>
<td>çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚ä¼˜å…ˆçº§èŒƒå›´æ ¹æ®ç³»ç»Ÿé…ç½®æƒ…å†µï¼ˆrtconfig.h ä¸­çš„ RT_THREAD_PRIORITY_MAX å®å®šä¹‰ï¼‰ï¼Œå¦‚æœæ”¯æŒçš„æ˜¯ 256 çº§ä¼˜å…ˆçº§ï¼Œé‚£ä¹ˆèŒƒå›´æ˜¯ä» 0~255ï¼Œæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œ0 ä»£è¡¨æœ€é«˜ä¼˜å…ˆçº§</td>
</tr>
<tr>
<td>tick</td>
<td>çº¿ç¨‹çš„æ—¶é—´ç‰‡å¤§å°ã€‚æ—¶é—´ç‰‡ï¼ˆtickï¼‰çš„å•ä½æ˜¯æ“ä½œç³»ç»Ÿçš„æ—¶é’ŸèŠ‚æ‹ã€‚å½“ç³»ç»Ÿä¸­å­˜åœ¨ç›¸åŒä¼˜å…ˆçº§çº¿ç¨‹æ—¶ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šçº¿ç¨‹ä¸€æ¬¡è°ƒåº¦èƒ½å¤Ÿè¿è¡Œçš„æœ€å¤§æ—¶é—´é•¿åº¦ã€‚è¿™ä¸ªæ—¶é—´ç‰‡è¿è¡Œç»“æŸæ—¶ï¼Œè°ƒåº¦å™¨è‡ªåŠ¨é€‰æ‹©ä¸‹ä¸€ä¸ªå°±ç»ªæ€çš„åŒä¼˜å…ˆçº§çº¿ç¨‹è¿›è¡Œè¿è¡Œ</td>
</tr>
<tr>
<td><strong>è¿”å›</strong></td>
<td>â€”â€”</td>
</tr>
<tr>
<td>thread</td>
<td>çº¿ç¨‹åˆ›å»ºæˆåŠŸï¼Œè¿”å›çº¿ç¨‹å¥æŸ„</td>
</tr>
<tr>
<td>RT_NULL</td>
<td>çº¿ç¨‹åˆ›å»ºå¤±è´¥</td>
</tr>
</tbody></table>
<p>å¯¹äºä¸€äº›ä½¿ç”¨ rt_thread_create() åˆ›å»ºå‡ºæ¥çš„çº¿ç¨‹ï¼Œå½“ä¸éœ€è¦ä½¿ç”¨ï¼Œæˆ–è€…è¿è¡Œå‡ºé”™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°æ¥å£æ¥ä»ç³»ç»Ÿä¸­æŠŠçº¿ç¨‹å®Œå…¨åˆ é™¤æ‰ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">rt_err_t <span class="token function">rt_thread_delete</span><span class="token punctuation">(</span>rt_thread_t thread<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è°ƒç”¨è¯¥å‡½æ•°åï¼Œçº¿ç¨‹å¯¹è±¡å°†ä¼šè¢«ç§»å‡ºçº¿ç¨‹é˜Ÿåˆ—å¹¶ä¸”ä»å†…æ ¸å¯¹è±¡ç®¡ç†å™¨ä¸­åˆ é™¤ï¼Œçº¿ç¨‹å ç”¨çš„å †æ ˆç©ºé—´ä¹Ÿä¼šè¢«é‡Šæ”¾ï¼Œæ”¶å›çš„ç©ºé—´å°†é‡æ–°ç”¨äºå…¶ä»–çš„å†…å­˜åˆ†é…ã€‚å®é™…ä¸Šï¼Œç”¨ rt_thread_delete() å‡½æ•°åˆ é™¤çº¿ç¨‹æ¥å£ï¼Œä»…ä»…æ˜¯æŠŠç›¸åº”çš„çº¿ç¨‹çŠ¶æ€æ›´æ”¹ä¸º RT_THREAD_CLOSE çŠ¶æ€ï¼Œç„¶åæ”¾å…¥åˆ° rt_thread_defunct é˜Ÿåˆ—ä¸­ï¼›è€ŒçœŸæ­£çš„åˆ é™¤åŠ¨ä½œï¼ˆé‡Šæ”¾çº¿ç¨‹æ§åˆ¶å—å’Œé‡Šæ”¾çº¿ç¨‹æ ˆï¼‰éœ€è¦åˆ°ä¸‹ä¸€æ¬¡æ‰§è¡Œç©ºé—²çº¿ç¨‹æ—¶ï¼Œç”±ç©ºé—²çº¿ç¨‹å®Œæˆæœ€åçš„çº¿ç¨‹åˆ é™¤åŠ¨ä½œã€‚çº¿ç¨‹åˆ é™¤ rt_thread_delete() æ¥å£çš„å‚æ•°å’Œè¿”å›å€¼è§ä¸‹è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th><strong>å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>thread</td>
<td>è¦åˆ é™¤çš„çº¿ç¨‹å¥æŸ„</td>
</tr>
<tr>
<td><strong>è¿”å›</strong></td>
<td>â€”â€”</td>
</tr>
<tr>
<td>RT_EOK</td>
<td>åˆ é™¤çº¿ç¨‹æˆåŠŸ</td>
</tr>
<tr>
<td>-RT_ERROR</td>
<td>åˆ é™¤çº¿ç¨‹å¤±è´¥</td>
</tr>
</tbody></table>
<h3 id="4-3-2ã€å¯åŠ¨çº¿ç¨‹"><a href="#4-3-2ã€å¯åŠ¨çº¿ç¨‹" class="headerlink" title="4.3.2ã€å¯åŠ¨çº¿ç¨‹"></a>4.3.2ã€å¯åŠ¨çº¿ç¨‹</h3><p>åˆ›å»ºï¼ˆåˆå§‹åŒ–ï¼‰çš„çº¿ç¨‹çŠ¶æ€å¤„äºåˆå§‹çŠ¶æ€ï¼Œå¹¶æœªè¿›å…¥å°±ç»ªçº¿ç¨‹çš„è°ƒåº¦é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çº¿ç¨‹åˆå§‹åŒ– / åˆ›å»ºæˆåŠŸåè°ƒç”¨ä¸‹é¢çš„å‡½æ•°æ¥å£è®©è¯¥çº¿ç¨‹è¿›å…¥å°±ç»ªæ€ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">rt_err_t <span class="token function">rt_thread_startup</span><span class="token punctuation">(</span>rt_thread_t thread<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å½“è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå°†æŠŠçº¿ç¨‹çš„çŠ¶æ€æ›´æ”¹ä¸ºå°±ç»ªçŠ¶æ€ï¼Œå¹¶æ”¾åˆ°ç›¸åº”ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ç­‰å¾…è°ƒåº¦ã€‚å¦‚æœæ–°å¯åŠ¨çš„çº¿ç¨‹ä¼˜å…ˆçº§æ¯”å½“å‰çº¿ç¨‹ä¼˜å…ˆçº§é«˜ï¼Œå°†ç«‹åˆ»åˆ‡æ¢åˆ°è¿™ä¸ªçº¿ç¨‹ã€‚çº¿ç¨‹å¯åŠ¨æ¥å£ rt_thread_startup() çš„å‚æ•°å’Œè¿”å›å€¼è§ä¸‹è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th><strong>å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>thread</td>
<td>çº¿ç¨‹å¥æŸ„</td>
</tr>
<tr>
<td><strong>è¿”å›</strong></td>
<td>â€”â€”</td>
</tr>
<tr>
<td>RT_EOK</td>
<td>çº¿ç¨‹å¯åŠ¨æˆåŠŸ</td>
</tr>
<tr>
<td>-RT_ERROR</td>
<td>çº¿ç¨‹å¯åŠ¨å¤±è´¥</td>
</tr>
</tbody></table>
<h3 id="4-3-3ã€é™æ€çº¿ç¨‹"><a href="#4-3-3ã€é™æ€çº¿ç¨‹" class="headerlink" title="4.3.3ã€é™æ€çº¿ç¨‹"></a>4.3.3ã€é™æ€çº¿ç¨‹</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">rt_thread_t th1_ptr = NULL; //ç»“æ„ä½“å˜é‡æ¥æ”¶è¿”å›å€¼
struct rt_thread th2;

rt_uint8_t th_2_stack[512] = {0};

void th1_entry(void *parameter)
{
    while(1){
        rt_kprintf("th1_entry running...\n");
        rt_thread_mdelay(1000);
    }
}

void th2_entry(void *parameter)
{
    int i = 0;
    for (i = 0; i &lt; 10; i++) {
        rt_kprintf("th2_entry running...\n");
//        rt_thread_mdelay(1000);
    }
}

int main(void)
{
    int ret = 0;

    //åŠ¨æ€çº¿ç¨‹åˆ›å»º-&gt;å‡½æ•°åç§°ã€å…¥å£å‡½æ•°ã€ç»™çº¿ç¨‹å…¥å£å‡½æ•°ä¼ å‚ã€çº¿ç¨‹æ ˆçš„å¤§å°ã€ä¼˜å…ˆçº§ã€ç³»ç»Ÿæ»´ç­”æ—¶é—´
    th1_ptr = rt_thread_create("th1_demo",th1_entry,NULL,1024,20,5);
    if (th1_ptr == RT_NULL) {
        LOG_E("rt_thread_create failed...\n");
        return RT_ENOMEM;
    }
    LOG_D("rt_thread_create succeed...\n");
    rt_thread_startup(th1_ptr);

    //é™æ€çº¿ç¨‹åˆå§‹åŒ–-&gt;çº¿ç¨‹å¯¹è±¡ã€å‡½æ•°åç§°ã€å…¥å£å‡½æ•°ã€å…¥å£å‡½æ•°å‚æ•°ã€çº¿ç¨‹æ ˆèµ·å§‹åœ°å€ã€çº¿ç¨‹æ ˆå¤§å°ã€ä¼˜å…ˆçº§ã€ç³»ç»Ÿæ»´ç­”æ—¶é—´
    ret = rt_thread_init(&amp;th2, "th2_demo", th2_entry , NULL, th_2_stack, sizeof(th_2_stack), 19, 5);
    if (ret &lt; 0) {
        LOG_E("rt_thread_init failed...\n");
        return ret;
    }
    LOG_D("rt_thread_init succeed...\n");
    rt_thread_startup(&amp;th2);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-C" data-language="C"><code class="language-C"> \ | /
- RT -     Thread Operating System
 / | \     4.0.3 build Oct 28 2021
 2006 - 2020 Copyright by rt-thread team
[0m[D/main] rt_thread_create succeed...
[0m
[0m[D/main] rt_thread_init succeed...
[0m
th2_entry running...
th2_entry running...
th2_entry running...
th2_entry running...
th2_entry running...
th2_entry running...
th2_entry running...
th2_entry running...
th2_entry running...
th2_entry running...
msh &gt;th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...
th1_entry running...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ³¨é‡Šth2_entryä¸­çš„å»¶æ—¶ï¼Œåˆ™ç”±äºé™æ€åˆå§‹åŒ–çš„ä¼˜å…ˆçº§æ›´é«˜ä¼šå…ˆæ‰“å°åæ¬¡ï¼Œåé¢å…¨éƒ¨åªä¼šæ‰“å°åŠ¨æ€çº¿ç¨‹</p>
<p>é™æ€çº¿ç¨‹çš„çº¿ç¨‹å¥æŸ„ï¼ˆæˆ–è€…è¯´çº¿ç¨‹æ§åˆ¶å—æŒ‡é’ˆï¼‰ã€çº¿ç¨‹æ ˆç”±ç”¨æˆ·æä¾›ã€‚é™æ€çº¿ç¨‹æ˜¯æŒ‡çº¿ç¨‹æ§åˆ¶å—ã€çº¿ç¨‹è¿è¡Œæ ˆä¸€èˆ¬éƒ½è®¾ç½®ä¸ºå…¨å±€å˜é‡ï¼Œåœ¨ç¼–è¯‘æ—¶å°±è¢«ç¡®å®šã€è¢«åˆ†é…å¤„ç†ï¼Œå†…æ ¸ä¸è´Ÿè´£åŠ¨æ€åˆ†é…å†…å­˜ç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”¨æˆ·æä¾›çš„æ ˆé¦–åœ°å€éœ€åšç³»ç»Ÿå¯¹é½ï¼ˆä¾‹å¦‚ ARM ä¸Šéœ€è¦åš 4 å­—èŠ‚å¯¹é½ï¼‰ã€‚çº¿ç¨‹åˆå§‹åŒ–æ¥å£ rt_thread_init() çš„å‚æ•°å’Œè¿”å›å€¼è§ä¸‹è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th><strong>å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>thread</td>
<td>çº¿ç¨‹å¥æŸ„ã€‚çº¿ç¨‹å¥æŸ„ç”±ç”¨æˆ·æä¾›å‡ºæ¥ï¼Œå¹¶æŒ‡å‘å¯¹åº”çš„çº¿ç¨‹æ§åˆ¶å—å†…å­˜åœ°å€</td>
</tr>
<tr>
<td>name</td>
<td>çº¿ç¨‹çš„åç§°ï¼›çº¿ç¨‹åç§°çš„æœ€å¤§é•¿åº¦ç”± rtconfig.h ä¸­å®šä¹‰çš„ RT_NAME_MAX å®æŒ‡å®šï¼Œå¤šä½™éƒ¨åˆ†ä¼šè¢«è‡ªåŠ¨æˆªæ‰</td>
</tr>
<tr>
<td>entry</td>
<td>çº¿ç¨‹å…¥å£å‡½æ•°</td>
</tr>
<tr>
<td>parameter</td>
<td>çº¿ç¨‹å…¥å£å‡½æ•°å‚æ•°</td>
</tr>
<tr>
<td>stack_start</td>
<td>çº¿ç¨‹æ ˆèµ·å§‹åœ°å€</td>
</tr>
<tr>
<td>stack_size</td>
<td>çº¿ç¨‹æ ˆå¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­éœ€è¦åšæ ˆç©ºé—´åœ°å€å¯¹é½ï¼ˆä¾‹å¦‚ ARM ä½“ç³»ç»“æ„ä¸­éœ€è¦å‘ 4 å­—èŠ‚åœ°å€å¯¹é½ï¼‰</td>
</tr>
<tr>
<td>priority</td>
<td>çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚ä¼˜å…ˆçº§èŒƒå›´æ ¹æ®ç³»ç»Ÿé…ç½®æƒ…å†µï¼ˆrtconfig.h ä¸­çš„ RT_THREAD_PRIORITY_MAX å®å®šä¹‰ï¼‰ï¼Œå¦‚æœæ”¯æŒçš„æ˜¯ 256 çº§ä¼˜å…ˆçº§ï¼Œé‚£ä¹ˆèŒƒå›´æ˜¯ä» 0 ï½ 255ï¼Œæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œ0 ä»£è¡¨æœ€é«˜ä¼˜å…ˆçº§</td>
</tr>
<tr>
<td>tick</td>
<td>çº¿ç¨‹çš„æ—¶é—´ç‰‡å¤§å°ã€‚æ—¶é—´ç‰‡ï¼ˆtickï¼‰çš„å•ä½æ˜¯æ“ä½œç³»ç»Ÿçš„æ—¶é’ŸèŠ‚æ‹ã€‚å½“ç³»ç»Ÿä¸­å­˜åœ¨ç›¸åŒä¼˜å…ˆçº§çº¿ç¨‹æ—¶ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šçº¿ç¨‹ä¸€æ¬¡è°ƒåº¦èƒ½å¤Ÿè¿è¡Œçš„æœ€å¤§æ—¶é—´é•¿åº¦ã€‚è¿™ä¸ªæ—¶é—´ç‰‡è¿è¡Œç»“æŸæ—¶ï¼Œè°ƒåº¦å™¨è‡ªåŠ¨é€‰æ‹©ä¸‹ä¸€ä¸ªå°±ç»ªæ€çš„åŒä¼˜å…ˆçº§çº¿ç¨‹è¿›è¡Œè¿è¡Œ</td>
</tr>
<tr>
<td><strong>è¿”å›</strong></td>
<td>â€”â€”</td>
</tr>
<tr>
<td>RT_EOK</td>
<td>çº¿ç¨‹åˆ›å»ºæˆåŠŸ</td>
</tr>
<tr>
<td>-RT_ERROR</td>
<td>çº¿ç¨‹åˆ›å»ºå¤±è´¥</td>
</tr>
</tbody></table>
<p>å¯¹äºç”¨ rt_thread_init() åˆå§‹åŒ–çš„çº¿ç¨‹ï¼Œä½¿ç”¨ rt_thread_detach() å°†ä½¿çº¿ç¨‹å¯¹è±¡åœ¨çº¿ç¨‹é˜Ÿåˆ—å’Œå†…æ ¸å¯¹è±¡ç®¡ç†å™¨ä¸­è¢«è„±ç¦»ã€‚çº¿ç¨‹è„±ç¦»å‡½æ•°å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">rt_err_t <span class="token function">rt_thread_detach</span> <span class="token punctuation">(</span>rt_thread_t thread<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>çº¿ç¨‹è„±ç¦»æ¥å£ rt_thread_detach() çš„å‚æ•°å’Œè¿”å›å€¼è§ä¸‹è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th><strong>å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>thread</td>
<td>çº¿ç¨‹å¥æŸ„ï¼Œå®ƒåº”è¯¥æ˜¯ç”± rt_thread_init è¿›è¡Œåˆå§‹åŒ–çš„çº¿ç¨‹å¥æŸ„ã€‚</td>
</tr>
<tr>
<td><strong>è¿”å›</strong></td>
<td>â€”â€”</td>
</tr>
<tr>
<td>RT_EOK</td>
<td>çº¿ç¨‹è„±ç¦»æˆåŠŸ</td>
</tr>
<tr>
<td>-RT_ERROR</td>
<td>çº¿ç¨‹è„±ç¦»å¤±è´¥</td>
</tr>
</tbody></table>
<p>è¿™ä¸ªå‡½æ•°æ¥å£æ˜¯å’Œ rt_thread_delete() å‡½æ•°ç›¸å¯¹åº”çš„ï¼Œ rt_thread_delete() å‡½æ•°æ“ä½œçš„å¯¹è±¡æ˜¯ rt_thread_create() åˆ›å»ºçš„å¥æŸ„ï¼Œè€Œ rt_thread_detach() å‡½æ•°æ“ä½œçš„å¯¹è±¡æ˜¯ä½¿ç”¨ rt_thread_init() å‡½æ•°åˆå§‹åŒ–çš„çº¿ç¨‹æ§åˆ¶å—ã€‚åŒæ ·ï¼Œçº¿ç¨‹æœ¬èº«ä¸åº”è°ƒç”¨è¿™ä¸ªæ¥å£è„±ç¦»çº¿ç¨‹æœ¬èº«ã€‚</p>
<p><em><u><strong>ç©ºé—²çº¿ç¨‹æ˜¯ä¸€ä¸ªçº¿ç¨‹çŠ¶æ€æ°¸è¿œä¸ºå°±ç»ªæ€çš„çº¿ç¨‹ï¼Œå› æ­¤è®¾ç½®çš„é’©å­å‡½æ•°å¿…é¡»ä¿è¯ç©ºé—²çº¿ç¨‹åœ¨ä»»ä½•æ—¶åˆ»éƒ½ä¸ä¼šå¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œå¦‚rt_thread_delay()ã€rt_thread_take()ç­‰å¯èƒ½ä¼šå¯¼è‡´çº¿ç¨‹æŒ‚èµ·çš„å‡½æ•°éƒ½ä¸èƒ½ä½¿ç”¨</strong></u></em></p>
<h3 id="4-3-4ã€é’©å­å‡½æ•°"><a href="#4-3-4ã€é’©å­å‡½æ•°" class="headerlink" title="4.3.4ã€é’©å­å‡½æ•°"></a>4.3.4ã€é’©å­å‡½æ•°</h3><p>åœ¨æ•´ä¸ªç³»ç»Ÿçš„è¿è¡Œæ—¶ï¼Œç³»ç»Ÿéƒ½å¤„äºçº¿ç¨‹è¿è¡Œã€ä¸­æ–­è§¦å‘ - å“åº”ä¸­æ–­ã€åˆ‡æ¢åˆ°å…¶ä»–çº¿ç¨‹ï¼Œç”šè‡³æ˜¯çº¿ç¨‹é—´çš„åˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œæˆ–è€…è¯´ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯ç³»ç»Ÿä¸­æœ€æ™®éçš„äº‹ä»¶ã€‚æœ‰æ—¶ç”¨æˆ·å¯èƒ½ä¼šæƒ³çŸ¥é“åœ¨ä¸€ä¸ªæ—¶åˆ»å‘ç”Ÿäº†ä»€ä¹ˆæ ·çš„çº¿ç¨‹åˆ‡æ¢ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ä¸‹é¢çš„å‡½æ•°æ¥å£è®¾ç½®ä¸€ä¸ªç›¸åº”çš„é’©å­å‡½æ•°ã€‚åœ¨ç³»ç»Ÿçº¿ç¨‹åˆ‡æ¢æ—¶ï¼Œè¿™ä¸ªé’©å­å‡½æ•°å°†è¢«è°ƒç”¨ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">rt_scheduler_sethook</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>hook<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">rt_thread</span><span class="token operator">*</span> from<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">rt_thread</span><span class="token operator">*</span> to<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>å¤åˆ¶é”™è¯¯å¤åˆ¶æˆåŠŸ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è®¾ç½®è°ƒåº¦å™¨é’©å­å‡½æ•°çš„è¾“å…¥å‚æ•°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th><strong>å‡½æ•°å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>hook</td>
<td>è¡¨ç¤ºç”¨æˆ·å®šä¹‰çš„é’©å­å‡½æ•°æŒ‡é’ˆ</td>
</tr>
</tbody></table>
<p>é’©å­å‡½æ•° hook() çš„å£°æ˜å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">hook</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">rt_thread</span><span class="token operator">*</span> from<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">rt_thread</span><span class="token operator">*</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>å¤åˆ¶é”™è¯¯å¤åˆ¶æˆåŠŸ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è°ƒåº¦å™¨é’©å­å‡½æ•° hook() çš„è¾“å…¥å‚æ•°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th><strong>å‡½æ•°å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>from</td>
<td>è¡¨ç¤ºç³»ç»Ÿæ‰€è¦åˆ‡æ¢å‡ºçš„çº¿ç¨‹æ§åˆ¶å—æŒ‡é’ˆ</td>
</tr>
<tr>
<td>to</td>
<td>è¡¨ç¤ºç³»ç»Ÿæ‰€è¦åˆ‡æ¢åˆ°çš„çº¿ç¨‹æ§åˆ¶å—æŒ‡é’ˆ</td>
</tr>
</tbody></table>
<p>æ³¨ï¼šè¯·ä»”ç»†ç¼–å†™ä½ çš„é’©å­å‡½æ•°ï¼Œç¨æœ‰ä¸æ…å°†å¾ˆå¯èƒ½å¯¼è‡´æ•´ä¸ªç³»ç»Ÿè¿è¡Œä¸æ­£å¸¸ï¼ˆåœ¨è¿™ä¸ªé’©å­å‡½æ•°ä¸­ï¼ŒåŸºæœ¬ä¸Šä¸å…è®¸è°ƒç”¨ç³»ç»Ÿ APIï¼Œæ›´ä¸åº”è¯¥å¯¼è‡´å½“å‰è¿è¡Œçš„ä¸Šä¸‹æ–‡æŒ‚èµ·ï¼‰ã€‚</p>
<h3 id="4-3-5ã€è®¾ç½®è°ƒåº¦å™¨hookå‡½æ•°"><a href="#4-3-5ã€è®¾ç½®è°ƒåº¦å™¨hookå‡½æ•°" class="headerlink" title="4.3.5ã€è®¾ç½®è°ƒåº¦å™¨hookå‡½æ•°"></a>4.3.5ã€è®¾ç½®è°ƒåº¦å™¨hookå‡½æ•°</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">rt_thread_t th1_ptr = NULL; //ç»“æ„ä½“å˜é‡æ¥æ”¶è¿”å›å€¼
struct rt_thread th2;

rt_uint8_t th_2_stack[512] = {0};

void th1_entry(void *parameter)
{
    int i = 0;
    for (i = 0; i &lt; 5; ++i) {
        rt_kprintf("th1_entry running...\n");
        rt_thread_mdelay(1000);
    }
}

void th2_entry(void *parameter)
{
    int i = 0;
    for (i = 0; i &lt; 5; i++) {
        rt_kprintf("th2_entry running...\n");
        rt_thread_mdelay(1000);
    }
}

void scheduler_hook(struct rt_thread *from, struct rt_thread *to)
{
    rt_kprintf("from:%s ---&gt; to:%s\n",from-&gt;name,to-&gt;name);
}

int main(void)
{
    int ret = 0;

    rt_scheduler_sethook(scheduler_hook);

    //åŠ¨æ€çº¿ç¨‹åˆ›å»º-&gt;å‡½æ•°åç§°ã€å…¥å£å‡½æ•°ã€ç»™çº¿ç¨‹å…¥å£å‡½æ•°ä¼ å‚ã€çº¿ç¨‹æ ˆçš„å¤§å°ã€ä¼˜å…ˆçº§ã€ç³»ç»Ÿæ»´ç­”æ—¶é—´
    th1_ptr = rt_thread_create("th1_demo",th1_entry,NULL,1024,20,5);
    if (th1_ptr == RT_NULL) {
        LOG_E("rt_thread_create failed...\n");
        return -RT_ENOMEM;
    }
    LOG_D("rt_thread_create succeed...\n");
    rt_thread_startup(th1_ptr);

    //é™æ€çº¿ç¨‹åˆå§‹åŒ–-&gt;çº¿ç¨‹å¯¹è±¡ã€å‡½æ•°åç§°ã€å…¥å£å‡½æ•°ã€å…¥å£å‡½æ•°å‚æ•°ã€çº¿ç¨‹æ ˆèµ·å§‹åœ°å€ã€çº¿ç¨‹æ ˆå¤§å°ã€ä¼˜å…ˆçº§ã€ç³»ç»Ÿæ»´ç­”æ—¶é—´
    ret = rt_thread_init(&amp;th2, "th2_demo", th2_entry , NULL, th_2_stack, sizeof(th_2_stack), 19, 5);
    if (ret &lt; 0) {
        LOG_E("rt_thread_init failed...\n");
        return ret;
    }
    LOG_D("rt_thread_init succeed...\n");
    rt_thread_startup(&amp;th2);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-C" data-language="C"><code class="language-C"> \ | /
- RT -     Thread Operating System
 / | \     4.0.3 build Oct 28 2021
 2006 - 2020 Copyright by rt-thread team
[0m[D/main] rt_thread_create succeed...
[0m
[0m[D/main] rt_thread_init succeed...
[0m
from:main ---&gt; to:th2_demo?
th2_entry running...
from:th2_demo? ---&gt; to:tshell
msh &gt;from:tshell ---&gt; to:th1_demo
th1_entry running...
from:th1_demo ---&gt; to:tidle0
from:tidle0 ---&gt; to:th2_demo?
th2_entry running...
from:th2_demo? ---&gt; to:tidle0
from:tidle0 ---&gt; to:th1_demo
th1_entry running...
from:th1_demo ---&gt; to:tidle0
from:tidle0 ---&gt; to:th2_demo?
th2_entry running...
from:th2_demo? ---&gt; to:tidle0
from:tidle0 ---&gt; to:th1_demo
th1_entry running...
from:th1_demo ---&gt; to:tidle0
from:tidle0 ---&gt; to:th2_demo?
th2_entry running...
from:th2_demo? ---&gt; to:tidle0
from:tidle0 ---&gt; to:th1_demo
th1_entry running...
from:th1_demo ---&gt; to:tidle0
from:tidle0 ---&gt; to:th2_demo?
th2_entry running...
from:th2_demo? ---&gt; to:tidle0
from:tidle0 ---&gt; to:th1_demo
th1_entry running...
from:th1_demo ---&gt; to:tidle0
from:tidle0 ---&gt; to:th2_demo?
from:th2_demo ---&gt; to:tidle0
from:tidle0 ---&gt; to:th1_demo
from:th1_demo ---&gt; to:tidle0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="äº”ã€æ—¶é’Ÿç®¡ç†"><a href="#äº”ã€æ—¶é’Ÿç®¡ç†" class="headerlink" title="äº”ã€æ—¶é’Ÿç®¡ç†"></a>äº”ã€æ—¶é’Ÿç®¡ç†</h1><p>æ“ä½œç³»ç»Ÿéœ€è¦é€šè¿‡<strong>æ—¶é—´</strong>æ¥è§„èŒƒå…¶<strong>ä»»åŠ¡</strong></p>
<h2 id="5-1ã€æ—¶é’ŸèŠ‚æ‹"><a href="#5-1ã€æ—¶é’ŸèŠ‚æ‹" class="headerlink" title="5.1ã€æ—¶é’ŸèŠ‚æ‹"></a>5.1ã€æ—¶é’ŸèŠ‚æ‹</h2><p>æ—¶é’ŸèŠ‚æ‹çš„é•¿åº¦å¯ä»¥æ ¹æ®RT_TICK_PER_SECONDçš„å®šä¹‰æ¥è°ƒæ•´ã€‚rtconfig.hé…ç½®æ–‡ä»¶ä¸­å®šä¹‰</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">/*
*é¢‘ç‡æ˜¯1000hzå‘¨æœŸæ˜¯1/1000ms
*æ‰€ä»¥èŠ‚æ‹æ˜¯1ms
*/
#define RT_TICK_PER_SECOND 1000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç³»ç»Ÿæ»´ç­”å®šæ—¶å™¨ä¸­æ–­å¤„ç†å‡½æ•°ï¼ˆæ¯1msè§¦å‘ä¸€æ¬¡systickå®šæ—¶å™¨ä¸­æ–­ï¼‰</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">/**
 * This is the timer interrupt service routine.
 *è¿™æ˜¯å®šæ—¶å™¨ä¸­æ–­æœåŠ¡ç¨‹åº
 */
void SysTick_Handler(void)
{
    /* enter interrupt */
    rt_interrupt_enter();

    HAL_IncTick();
    rt_tick_increase();//++rt_tick;å…¨å±€å˜é‡è‡ªåŠ ï¼Œè®°å½•çš„æ˜¯ç³»ç»Ÿä»å¯åŠ¨åˆ°ç°åœ¨çš„æ—¶é—´èŠ‚æ‹æ•°

    /* leave interrupt */
    rt_interrupt_leave();
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="5-2ã€è·å–ç³»ç»ŸèŠ‚æ‹"><a href="#5-2ã€è·å–ç³»ç»ŸèŠ‚æ‹" class="headerlink" title="5.2ã€è·å–ç³»ç»ŸèŠ‚æ‹"></a>5.2ã€è·å–ç³»ç»ŸèŠ‚æ‹</h2><h3 id="5-2-1ã€è·å–ç³»ç»Ÿè®¡æ•°å‡½æ•°"><a href="#5-2-1ã€è·å–ç³»ç»Ÿè®¡æ•°å‡½æ•°" class="headerlink" title="5.2.1ã€è·å–ç³»ç»Ÿè®¡æ•°å‡½æ•°"></a>5.2.1ã€è·å–ç³»ç»Ÿè®¡æ•°å‡½æ•°</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">/**
 * This function will return current tick from operating system startup
 *
 * @return current tick
 */
rt_tick_t rt_tick_get(void)
{
    /* return the global tick */
    return rt_tick;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-C" data-language="C"><code class="language-C">int main(void)
{
    int i = 0;
    rt_tick_t tick = 0;
    for (i = 0; i &lt; 10; ++i) {
        tick = rt_tick_get();
        rt_kprintf("tick:%u\n",tick);
        rt_thread_mdelay(500);//ä¼‘çœ 500ms
    }
    return RT_EOK;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥æ‰“å°å‡ºæ—¶é’ŸèŠ‚æ‹</p>
<h2 id="5-3ã€å®šæ—¶å™¨"><a href="#5-3ã€å®šæ—¶å™¨" class="headerlink" title="5.3ã€å®šæ—¶å™¨"></a>5.3ã€å®šæ—¶å™¨</h2><p>å®šæ—¶å™¨ï¼Œæ˜¯æŒ‡ä»æŒ‡å®šçš„æ—¶åˆ»å¼€å§‹ï¼Œç»è¿‡ä¸€å®šçš„æŒ‡å®šæ—¶é—´åè§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œä¾‹å¦‚å®šä¸ªæ—¶é—´æé†’ç¬¬äºŒå¤©èƒ½å¤ŸæŒ‰æ—¶èµ·åºŠã€‚å®šæ—¶å™¨æœ‰<strong>ç¡¬ä»¶å®šæ—¶å™¨</strong>å’Œ<strong>è½¯ä»¶å®šæ—¶å™¨</strong>ä¹‹åˆ†ï¼š</p>
<p>1ï¼‰<strong>ç¡¬ä»¶å®šæ—¶å™¨</strong>æ˜¯èŠ¯ç‰‡æœ¬èº«æä¾›çš„å®šæ—¶åŠŸèƒ½ã€‚ä¸€èˆ¬æ˜¯ç”±å¤–éƒ¨æ™¶æŒ¯æä¾›ç»™èŠ¯ç‰‡è¾“å…¥æ—¶é’Ÿï¼ŒèŠ¯ç‰‡å‘è½¯ä»¶æ¨¡å—æä¾›ä¸€ç»„é…ç½®å¯„å­˜å™¨ï¼Œæ¥å—æ§åˆ¶è¾“å…¥ï¼Œåˆ°è¾¾è®¾å®šæ—¶é—´å€¼åèŠ¯ç‰‡ä¸­æ–­æ§åˆ¶å™¨äº§ç”Ÿæ—¶é’Ÿä¸­æ–­ã€‚ç¡¬ä»¶å®šæ—¶å™¨çš„ç²¾åº¦ä¸€èˆ¬å¾ˆé«˜ï¼Œå¯ä»¥è¾¾åˆ°çº³ç§’çº§åˆ«ï¼Œå¹¶ä¸”æ˜¯ä¸­æ–­è§¦å‘æ–¹å¼ã€‚</p>
<p>2ï¼‰<strong>è½¯ä»¶å®šæ—¶å™¨</strong>æ˜¯ç”±æ“ä½œç³»ç»Ÿæä¾›çš„ä¸€ç±»ç³»ç»Ÿæ¥å£ï¼Œå®ƒæ„å»ºåœ¨ç¡¬ä»¶å®šæ—¶å™¨åŸºç¡€ä¹‹ä¸Šï¼Œä½¿ç³»ç»Ÿèƒ½å¤Ÿæä¾›ä¸å—æ•°ç›®é™åˆ¶çš„å®šæ—¶å™¨æœåŠ¡ã€‚</p>
<p>RT-Thread æ“ä½œç³»ç»Ÿæä¾›è½¯ä»¶å®ç°çš„å®šæ—¶å™¨ï¼Œä»¥æ—¶é’ŸèŠ‚æ‹ï¼ˆOS Tickï¼‰çš„æ—¶é—´é•¿åº¦ä¸ºå•ä½ï¼Œå³å®šæ—¶æ•°å€¼å¿…é¡»æ˜¯ OS Tick çš„æ•´æ•°å€ï¼Œä¾‹å¦‚ä¸€ä¸ª OS Tick æ˜¯ 10msï¼Œé‚£ä¹ˆä¸Šå±‚è½¯ä»¶å®šæ—¶å™¨åªèƒ½æ˜¯ 10msï¼Œ20msï¼Œ100ms ç­‰ï¼Œè€Œä¸èƒ½å®šæ—¶ä¸º 15msã€‚RT-Thread çš„å®šæ—¶å™¨ä¹ŸåŸºäºç³»ç»Ÿçš„èŠ‚æ‹ï¼Œæä¾›äº†åŸºäºèŠ‚æ‹æ•´æ•°å€çš„å®šæ—¶èƒ½åŠ›ã€‚</p>
<p><strong>HSE</strong>ï¼šå¤–éƒ¨æ—¶é’Ÿ</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">å¼ å›éŸµ</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://tqoqt.github.io/posts/rtt1.html">https://tqoqt.github.io/posts/rtt1.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">å¼ å›éŸµ</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/keil/">
                                    <span class="chip bg-color">keil</span>
                                </a>
                            
                                <a href="/tags/RT-Thread/">
                                    <span class="chip bg-color">RT_Thread</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,twitter,facebook,google,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/null" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/null" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    .v[data-class="v"] .vwrap .vheader .vinput {
      width: 32%;
      border-bottom: 1px dashed #dedede;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>è¯„è®º</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
let metaPlaceholder = {"nick":"æ˜µç§°/QQå·(å¿…å¡«)","mail":"é‚®ç®±(å¿…å¡«)","link":"ç½‘å€(https://)"} ;
//è¿™é‡Œè¦æ¢è¡Œ
new Valine({
        el: '#vcomments',
        appId: 'Ucrxxxxxxxxxxxxxxxx-xxxxsz',
        appKey: 'zPsLxxxxxxxxxxxxxxerLmd',
        notify: 'true' === 'true',
        verify: 'true' === 'true',
        visitor: 'true' === 'true',
        avatar: 'monsterid',
        pageSize: '10',
        lang: 'zh-CN',
        placeholder: 'ç•™ä¸‹ä½ çš„è¶³è¿¹..',
        meta: ["nick", "mail", "link"],
        recordIP: 'true' === 'true',
        enableQQ: 'monsterid',
        requiredFields: ["46606772953bed0812789d6dc955614e"],
        master: ["46606772953bed0812789d6dc955614e"],
        friends: ["cb3e577ff029d6073400d5557effd41f", ""],
        tagMeta: ["åšä¸»", "å°ä¼™ä¼´", "è®¿å®¢"],
        metaPlaceholder: metaPlaceholder,

    });

    document.body.addEventListener('click', function(e) {
        if (e.target.classList.contains('vsubmit')) {
            const email = document.querySelector('input[type=email]');
            const nick = document.querySelector('input[name=nick]');
            const reg = /^[A-Za-z0-9_-\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;
            if (!email.value || !nick.value || !reg.test(email.value)) {
                const str = `<div class="valert txt-center"><div class="vtext">è¯·å¡«å†™æ­£ç¡®çš„æ˜µç§°å’Œé‚®ç®±ï¼</div></div>`;
                const vmark = document.querySelector('.vmark');
                vmark.innerHTML = str;
                vmark.style.display = 'block';

                e.stopPropagation();

                setTimeout(function() {
                    vmark.style.display = 'none';
                    vmark.innerHTML = '';
                }, 2500);
            }
        }
        }, true);
</script>



    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/posts/github.html">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/LuckyZmj/imgbed@master/posts/20200928021815.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            GitHubè®¿é—®æ…¢é—®é¢˜
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-10-26
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%8A%80%E5%B7%A7%E7%AF%87/" class="post-category">
                                    æŠ€å·§ç¯‡
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/GitHub/">
                        <span class="chip bg-color">GitHub</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/keil1.html">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/LuckyZmj/imgbed@master/posts/20200928020939.jpg" class="responsive-img" alt="keilç­‰çš„å¼€å‘ç¯å¢ƒ">
                        
                        <span class="card-title">keilç­‰çš„å¼€å‘ç¯å¢ƒ</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            é˜²æ­¢åœ¨æ–°ç”µè„‘ä¸Šæ¯”è¾ƒéš¾å¸ƒç½®å¼€å‘ç¯å¢ƒç‰¹å†™æ­¤åšå®¢
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-09-07
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%AF%87/" class="post-category">
                                    å¼€å‘ç¯å¢ƒç¯‡
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/STM32CubeMX/">
                        <span class="chip bg-color">STM32CubeMX</span>
                    </a>
                    
                    <a href="/tags/keil/">
                        <span class="chip bg-color">keil</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'æ¥æº: å¼ å›éŸµ<br />'
            + 'æ–‡ç« ä½œè€…: å¼ å›éŸµ<br />'
            + 'æ–‡ç« é“¾æ¥: <a href="' + url + '">' + url + '</a><br />'
            + 'æœ¬æ–‡ç« è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½éƒ½è¯·æ³¨æ˜å‡ºå¤„ã€‚';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="playlist"
                   id="2376720241"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">å¼ å›éŸµ</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                class="white-color">19.3k</span>&nbsp;å­—
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;æ¬¡
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;äºº
            </span>
            
            <br>
            
            <span id="sitetime">è½½å…¥è¿è¡Œæ—¶é—´...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2021";
                    var startMonth = "7";
                    var startDate = "31";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + diffDays + " å¤© " + diffHours +
                            " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + diffYears + " å¹´ " + diffDays +
                            " å¤© " + diffHours + " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="http://www.beian.miit.gov.cn/" target="_blank">é—½ICPå¤‡xxxxxxxå·-1</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/TQOQT/" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2094668015@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2094668015" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 2094668015" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>



    <a href="6788560391" class="tooltipped" target="_blank" data-tooltip="å…³æ³¨æˆ‘çš„å¾®åš: 6788560391" data-position="top" data-delay="50">
        <i class="fab fa-weibo"></i>
    </a>





    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.11/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?aaa6c944b0ed07922901d7fc571a171d";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

<!-- æ·±è‰²æ¨¡å¼æŒ‰é’® -->
    <script>
        if (localStorage.getItem('dark') === '1') {
        document.body.classList.add('dark');
        }
        else if (new Date().getHours() >= 22 || new Date().getHours() < 7) {
        document.body.classList.add('dark');
        } 
        else if (matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
        }
    </script>
    <a onclick="switchNightMode()" id="sma">
        <i class="fas fa-lightbulb" id="nightMode" aria-hidden="true"></i>
    </a>

    <!-- å¤©æ°”æ¥å£æ§ä»¶   -->
    
        <script type="text/javascript">
        WIDGET = {FID: 'zLkJSQpqsh'}
        </script>
    <!-- <script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"></script> -->

    <script type="text/javascript">
      var windowWidth = $(window).width();
      if (windowWidth > 768) {
          document.write('<script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"><\/script>');
      }
    </script>
    

    
    <script>
        (function (i, s, o, g, r, a, m) {
            i["DaoVoiceObject"] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o), m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            a.charset = "utf-8";
            m.parentNode.insertBefore(a, m)
        })(window, document, "script", ('https:' == document.location.protocol ? 'https:' : 'http:') +
            "//widget.daovoice.io/widget/6984b559.js", "daovoice")
        daovoice('init', {
            app_id: "4xxxxxxxe"
        });
        daovoice('update');
    </script>
    

	
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"live2d-widget-model-chitose"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"react":{"opacityDefault":1,"opacityOnHover":1},"log":false,"tagMode":false});</script></body>

</html>
